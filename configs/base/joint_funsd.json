{
    "architecture":{
        "ernie":"./configs/ernie_config/ernie_base.json",
        "cls_header":{
            "num_labels":4
        },
        "linking_types":{
          "start_cls":[1,2],
          "end_cls":[2,3]
        },
        "visual_backbone":{
            "module":"model.backbones.resnet_vd",
            "class":"ResNetVd",
            "params":{
                "layers":50
            },
            "fpn_dim":128
        },
        "embedding":{
            "roi_width":64,
            "roi_height":4,
            "rel_pos_size":36,
            "spa_pos_size":256,
            "max_seqlen":512,
            "max_2d_position_embedding":512
        }
    },
    "train":{
        "feed_names":[
            "images",
            "sentence",
            "sentence_ids",
            "sentence_pos",
            "sentence_mask",
            "sentence_bboxes",
            "cls_label",
            "link_label",
            "label_mask"
        ],
        "epoch" : 1,
        "loss" : {
            "loss_bce" : 1.0,
            "loss_rank" : 1.0
        },
        "optimizer" : {
            "lr" : 0.0001,
            "epsilon" : 0.0001,
            "weight_decay" : 0.1,
            "warmup_steps" : 1
        },
        "loader":{
            "collect_batch":false,
            "num_workers":5
        },
        "metric":[
            {
                "name":"labeling_cls",
                "label_names":["other", "header", "question", "answer"],
                "ignore_idx":[0],
                "type":"TabClsMetric"
            },
            {
                "name":"linking_re",
                "type":"ReScoreMetric",
                "mode":"boundaries",
                "threshold": 0.5
            }
        ],
        "dataset":{
            "data_path":"./FUNSD/dataset/training_data/test_labels",
            "image_path":"./FUNSD/dataset/training_data/images",
            "dict_path":"./configs/ernie_config/vocab.txt",
            "dict_params":{
                "lower":true,
                "unk_token":"[UNK]",
                "sep_token":"[SEP]",
                "cls_token":"[CLS]",
                "pad_token":"[PAD]",
                "img_token":"[IMG]",
                "mask_token":"[MASK]"
            },
            "batch_size":1,
            "shuffle":false,
            "image_shape":[
                512,
                512
            ],
            "transform":{
                "img_mode":"RGB",
                "channel_first":false,
                "scale":"1./255",
                "mean":[
                    0.485,
                    0.456,
                    0.406
                ],
                "std":[
                    0.229,
                    0.224,
                    0.225
                ],
                "order":"",
                "to_chw":true
            }
        }
    },
    "eval":{
        "feed_names":[
            "images",
            "sentence",
            "sentence_ids",
            "sentence_pos",
            "sentence_mask",
            "sentence_bboxes",
            "cls_label",
            "link_label",
            "label_mask"
        ],
        "loader":{
            "collect_batch":false,
            "num_workers":5
        },
        "metric":[
            {
                "name":"labeling_cls",
                "label_names":["other", "header", "question", "answer"],
                "ignore_idx":[0],
                "type":"TabClsMetric"
            },
            {
                "name":"linking_re",
                "type":"ReScoreMetric",
                "mode":"boundaries",
                "threshold": 0.5
            }
        ],
        "dataset":{
            "data_path":"./FUNSD/dataset/testing_data/test_labels",
            "image_path":"./FUNSD/dataset/testing_data/images",
            "dict_path":"./configs/ernie_config/vocab.txt",
            "dict_params":{
                "lower":true,
                "unk_token":"[UNK]",
                "sep_token":"[SEP]",
                "cls_token":"[CLS]",
                "pad_token":"[PAD]",
                "img_token":"[IMG]",
                "mask_token":"[MASK]"
            },
            "batch_size":5,
            "shuffle":false,
            "image_shape":[
                512,
                512
            ],
            "transform":{
                "img_mode":"RGB",
                "channel_first":false,
                "scale":"1./255",
                "mean":[
                    0.485,
                    0.456,
                    0.406
                ],
                "std":[
                    0.229,
                    0.224,
                    0.225
                ],
                "order":"",
                "to_chw":true
            }
        }
    },
    "monitoring" : {
        "log_iter" : 1,
        "save_module" : 1,
        "save_dir" : "models/"
    }
}
